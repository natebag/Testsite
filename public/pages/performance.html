<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Analytics - MLG.clan</title>
    <link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Main Styles -->
    <link rel="stylesheet" href="/src/styles/main.css">
    <link rel="stylesheet" href="/src/styles/performance-dashboard.css">
    
    <!-- Meta Tags -->
    <meta name="description" content="Real-time performance analytics and monitoring for MLG.clan gaming platform">
    <meta name="keywords" content="performance, analytics, gaming, monitoring, optimization">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Performance Analytics - MLG.clan">
    <meta property="og:description" content="Monitor and optimize your gaming performance with real-time analytics">
    <meta property="og:type" content="website">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/src/styles/main.css" as="style">
    <link rel="preload" href="/src/shared/performance/PerformanceIntegration.js" as="script">
</head>
<body class="bg-gaming-bg text-white min-h-screen">
    <!-- Navigation Header -->
    <nav class="bg-gaming-surface border-b border-gaming-accent/30 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <a href="/index.html" class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gaming-accent rounded-full flex items-center justify-center">
                            <span class="text-black font-bold text-sm">M</span>
                        </div>
                        <span class="text-xl font-bold">MLG.clan</span>
                    </a>
                    
                    <div class="hidden md:flex items-center space-x-4">
                        <a href="/index.html" class="text-gray-300 hover:text-gaming-accent transition-colors">Home</a>
                        <a href="/public/pages/voting.html" class="text-gray-300 hover:text-gaming-accent transition-colors">Voting</a>
                        <a href="/public/pages/clans.html" class="text-gray-300 hover:text-gaming-accent transition-colors">Clans</a>
                        <a href="/public/pages/content.html" class="text-gray-300 hover:text-gaming-accent transition-colors">Content</a>
                        <a href="/public/pages/analytics.html" class="text-gray-300 hover:text-gaming-accent transition-colors">Analytics</a>
                        <a href="/public/pages/performance.html" class="text-gaming-accent border-b-2 border-gaming-accent">Performance</a>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="performance-status-indicator">
                        <div class="status-dot" id="performance-status"></div>
                        <span class="status-text" id="performance-text">Monitoring</span>
                    </div>
                    
                    <button id="wallet-connect" class="px-4 py-2 bg-gaming-purple hover:bg-gaming-purple/80 rounded-lg transition-colors">
                        Connect Wallet
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Performance Dashboard Header -->
        <div class="mb-8">
            <h1 class="text-4xl font-bold text-gaming-accent mb-2">Performance Analytics</h1>
            <p class="text-gray-300 text-lg">Real-time performance monitoring and optimization insights for competitive gaming</p>
        </div>

        <!-- Performance Dashboard Container -->
        <div id="performance-dashboard-container" class="w-full">
            <!-- Loading State -->
            <div id="dashboard-loading" class="flex items-center justify-center py-20">
                <div class="text-center">
                    <div class="xbox-loading-ring mb-4"></div>
                    <p class="text-gaming-accent">Initializing Performance Analytics...</p>
                </div>
            </div>
            
            <!-- Dashboard will be mounted here -->
            <div id="performance-dashboard" style="display: none;"></div>
        </div>

        <!-- Quick Actions Section -->
        <div class="mt-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="bg-gaming-surface/50 border border-gaming-accent/30 rounded-lg p-6 hover:bg-gaming-surface/70 transition-colors cursor-pointer" onclick="performQuickAnalysis()">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gaming-accent/20 rounded-full flex items-center justify-center">
                        <span class="text-gaming-accent">âš¡</span>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Quick Analysis</h3>
                        <p class="text-gray-400 text-sm">Run performance check</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-gaming-surface/50 border border-gaming-accent/30 rounded-lg p-6 hover:bg-gaming-surface/70 transition-colors cursor-pointer" onclick="exportPerformanceData()">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gaming-blue/20 rounded-full flex items-center justify-center">
                        <span class="text-gaming-blue">ðŸ“Š</span>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Export Data</h3>
                        <p class="text-gray-400 text-sm">Download performance report</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-gaming-surface/50 border border-gaming-accent/30 rounded-lg p-6 hover:bg-gaming-surface/70 transition-colors cursor-pointer" onclick="viewOptimizations()">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gaming-yellow/20 rounded-full flex items-center justify-center">
                        <span class="text-gaming-yellow">ðŸŽ¯</span>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Optimizations</h3>
                        <p class="text-gray-400 text-sm">View recommendations</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-gaming-surface/50 border border-gaming-accent/30 rounded-lg p-6 hover:bg-gaming-surface/70 transition-colors cursor-pointer" onclick="viewAlerts()">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gaming-red/20 rounded-full flex items-center justify-center">
                        <span class="text-gaming-red">ðŸš¨</span>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Alerts</h3>
                        <p class="text-gray-400 text-sm" id="active-alerts-count">No active alerts</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Tips Section -->
        <div class="mt-12 bg-gaming-surface/30 border border-gaming-accent/20 rounded-lg p-8">
            <h2 class="text-2xl font-bold text-gaming-accent mb-4">âš¡ Performance Tips</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white">Gaming Performance</h3>
                    <ul class="space-y-2 text-gray-300">
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Use a stable internet connection for voting operations</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Keep browser tabs minimal during tournaments</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Enable hardware acceleration in browser settings</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Close unnecessary applications during competitive gaming</span>
                        </li>
                    </ul>
                </div>
                
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white">Platform Optimization</h3>
                    <ul class="space-y-2 text-gray-300">
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Clear browser cache regularly for optimal performance</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Use latest browser version for best compatibility</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Monitor memory usage during long gaming sessions</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <span class="text-gaming-accent mt-1">â€¢</span>
                            <span>Check performance metrics regularly in dashboard</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gaming-surface border-t border-gaming-accent/30 mt-20">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center text-gray-400">
                <p>&copy; 2025 MLG.clan - Performance Analytics Dashboard</p>
                <p class="text-sm mt-2">Real-time monitoring â€¢ Gaming optimization â€¢ Competitive insights</p>
            </div>
        </div>
    </footer>

    <!-- Performance Monitoring Scripts -->
    <script type="module">
        import { performanceIntegration } from '/src/shared/performance/PerformanceIntegration.js';
        import PerformanceDashboard from '/src/shared/components/PerformanceDashboard.jsx';
        
        let dashboardMounted = false;
        
        // Initialize performance monitoring
        async function initializePerformance() {
            try {
                // Wait for performance integration to be ready
                if (!performanceIntegration.isReady()) {
                    await performanceIntegration.initialize();
                }
                
                // Mount the performance dashboard
                mountPerformanceDashboard();
                
                // Set up real-time updates
                setupRealTimeUpdates();
                
                // Update status indicator
                updateStatusIndicator('operational', 'Operational');
                
            } catch (error) {
                console.error('Failed to initialize performance monitoring:', error);
                updateStatusIndicator('error', 'Error');
            }
        }
        
        // Mount the performance dashboard React component
        function mountPerformanceDashboard() {
            const container = document.getElementById('performance-dashboard');
            const loading = document.getElementById('dashboard-loading');
            
            if (container && !dashboardMounted) {
                // Hide loading state
                loading.style.display = 'none';
                container.style.display = 'block';
                
                // Mount dashboard component (would use React.render in real implementation)
                container.innerHTML = '<div class="performance-dashboard dark">Dashboard will be mounted here</div>';
                dashboardMounted = true;
            }
        }
        
        // Setup real-time updates
        function setupRealTimeUpdates() {
            // Update performance status every 30 seconds
            setInterval(updatePerformanceStatus, 30000);
            
            // Update active alerts count
            setInterval(updateAlertsCount, 15000);
            
            // Trigger periodic analysis
            setInterval(() => {
                performanceIntegration.triggerPerformanceAnalysis();
            }, 60000);
        }
        
        // Update performance status indicator
        function updateStatusIndicator(status, text) {
            const statusDot = document.getElementById('performance-status');
            const statusText = document.getElementById('performance-text');
            
            if (statusDot && statusText) {
                statusDot.className = `status-dot ${status}`;
                statusText.textContent = text;
            }
        }
        
        // Update performance status
        async function updatePerformanceStatus() {
            try {
                const dashboardData = performanceIntegration.getPerformanceDashboardData();
                
                if (dashboardData && dashboardData.alerts) {
                    const criticalAlerts = dashboardData.alerts.filter(alert => 
                        alert.level === 'critical' && !alert.resolved
                    );
                    
                    if (criticalAlerts.length > 0) {
                        updateStatusIndicator('critical', 'Critical Issues');
                    } else if (dashboardData.alerts.length > 0) {
                        updateStatusIndicator('warning', 'Warnings');
                    } else {
                        updateStatusIndicator('operational', 'Operational');
                    }
                }
            } catch (error) {
                console.warn('Failed to update performance status:', error);
            }
        }
        
        // Update alerts count
        async function updateAlertsCount() {
            try {
                const dashboardData = performanceIntegration.getPerformanceDashboardData();
                const alertsCountElement = document.getElementById('active-alerts-count');
                
                if (alertsCountElement && dashboardData && dashboardData.alerts) {
                    const activeAlerts = dashboardData.alerts.filter(alert => !alert.resolved);
                    const count = activeAlerts.length;
                    
                    alertsCountElement.textContent = count > 0 ? 
                        `${count} active alert${count === 1 ? '' : 's'}` : 
                        'No active alerts';
                }
            } catch (error) {
                console.warn('Failed to update alerts count:', error);
            }
        }
        
        // Quick action functions
        window.performQuickAnalysis = async function() {
            updateStatusIndicator('analyzing', 'Analyzing...');
            
            try {
                performanceIntegration.triggerPerformanceAnalysis();
                
                // Show analysis results after a delay
                setTimeout(() => {
                    alert('Quick analysis completed! Check the dashboard for results.');
                    updatePerformanceStatus();
                }, 2000);
                
            } catch (error) {
                console.error('Quick analysis failed:', error);
                alert('Analysis failed. Please try again.');
                updateStatusIndicator('error', 'Error');
            }
        };
        
        window.exportPerformanceData = async function() {
            try {
                const data = await performanceIntegration.exportPerformanceData();
                
                if (data) {
                    // Create download link
                    const blob = new Blob([JSON.stringify(data, null, 2)], {
                        type: 'application/json'
                    });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `mlg-performance-report-${Date.now()}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    alert('Performance data exported successfully!');
                }
            } catch (error) {
                console.error('Export failed:', error);
                alert('Failed to export performance data. Please try again.');
            }
        };
        
        window.viewOptimizations = function() {
            // Switch to recommendations section in dashboard
            const dashboard = document.getElementById('performance-dashboard');
            if (dashboard) {
                dashboard.scrollIntoView({ behavior: 'smooth' });
                // Would trigger navigation to recommendations tab
            }
        };
        
        window.viewAlerts = function() {
            // Switch to alerts section in dashboard
            const dashboard = document.getElementById('performance-dashboard');
            if (dashboard) {
                dashboard.scrollIntoView({ behavior: 'smooth' });
                // Would trigger navigation to alerts tab
            }
        };
        
        // Track page-specific performance
        performanceIntegration.trackPageOperation = function(operationType, data) {
            console.log(`Performance: ${operationType}`, data);
        };
        
        // Initialize when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePerformance);
        } else {
            initializePerformance();
        }
        
        // Track page visibility for gaming context
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                // Page became visible - refresh performance data
                updatePerformanceStatus();
                updateAlertsCount();
            }
        });
    </script>
    
    <!-- Additional Styles for Performance Page -->
    <style>
        .performance-status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(26, 26, 46, 0.5);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #666;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .status-dot.operational {
            background: #00ff88;
            box-shadow: 0 0 8px rgba(0, 255, 136, 0.5);
        }
        
        .status-dot.warning {
            background: #fbbf24;
            box-shadow: 0 0 8px rgba(251, 191, 36, 0.5);
        }
        
        .status-dot.critical {
            background: #ef4444;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);
        }
        
        .status-dot.error {
            background: #ef4444;
            animation: blink 1s linear infinite;
        }
        
        .status-dot.analyzing {
            background: #3b82f6;
            animation: spin 1s linear infinite;
        }
        
        .status-text {
            color: #ffffff;
            font-weight: 500;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .xbox-loading-ring {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 255, 136, 0.2);
            border-top: 3px solid #00ff88;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
    </style>
</body>
</html>