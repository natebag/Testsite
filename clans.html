<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clan Hub - Complete Clan Management | MLG.clan</title>
  
  <!-- Meta Tags -->
  <meta name="description" content="Clan Hub - Create and manage gaming clans with token staking, governance, and competitive leaderboards.">
  <meta name="keywords" content="clans, gaming, esports, management, tournaments, MLG, Solana, blockchain">
  <meta name="author" content="MLG.clan Development Team">
  
  <!-- Security Headers -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://unpkg.com https://cdn.socket.io; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; img-src 'self' data: blob: https:; connect-src 'self' wss: https: ws://localhost:3000; frame-src 'self' https://www.youtube.com https://player.twitch.tv https://www.tiktok.com; font-src 'self' data:;">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèõÔ∏è</text></svg>">
  
  <!-- External Dependencies -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- Socket.IO for Real-time Updates -->
  <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
  
  <!-- Solana Web3.js -->
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  
  <!-- API Client -->
  <script src="src/js/api-client.js"></script>

  <!-- Tailwind Configuration -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'gaming-bg': '#0a0a0f',
            'gaming-surface': '#1a1a2e',
            'gaming-accent': '#00ff88',
            'gaming-purple': '#8b5cf6',
            'gaming-blue': '#3b82f6',
            'gaming-yellow': '#fbbf24',
            'gaming-red': '#ef4444'
          },
          animation: {
            'pulse-neon': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'float': 'float 6s ease-in-out infinite'
          }
        }
      }
    }
  </script>
  
  <style>
    /* Gaming Theme Styles */
    :root {
      --neon-green: #00ff88;
      --neon-blue: #00ffff;
      --neon-purple: #8b5cf6;
      --dark-bg: #0a0a0f;
      --card-bg: #1a1a2e;
    }
    
    body {
      background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0a0a0f 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow-x: hidden;
    }
    
    .neon-glow {
      box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green);
      border: 1px solid var(--neon-green);
    }
    
    .card-glow {
      background: rgba(26, 26, 46, 0.95);
      border: 1px solid rgba(0, 255, 136, 0.2);
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
    }
    
    .card-glow:hover {
      border-color: rgba(0, 255, 136, 0.5);
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.1);
      transform: translateY(-2px);
    }
    
    .clan-card {
      background: rgba(26, 26, 46, 0.95);
      border: 1px solid rgba(139, 92, 246, 0.2);
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
    }
    
    .clan-card:hover {
      border-color: rgba(139, 92, 246, 0.5);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.1);
      transform: translateY(-2px);
    }
    
    .status-online {
      position: relative;
    }
    
    .status-online::before {
      content: '';
      position: absolute;
      top: -2px;
      right: -2px;
      width: 12px;
      height: 12px;
      background: var(--neon-green);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    .loading-spinner {
      border: 2px solid rgba(0, 255, 136, 0.1);
      border-left: 2px solid var(--neon-green);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes glow {
      from { box-shadow: 0 0 10px var(--neon-green); }
      to { box-shadow: 0 0 20px var(--neon-green), 0 0 30px var(--neon-green); }
    }
    
    .clan-sort-btn {
      background: rgba(26, 26, 46, 0.8);
      border: 1px solid rgba(0, 255, 136, 0.2);
      color: rgba(255, 255, 255, 0.7);
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .clan-sort-btn:hover {
      border-color: rgba(0, 255, 136, 0.4);
      background: rgba(0, 255, 136, 0.1);
      color: white;
    }
    
    .clan-sort-btn.active {
      background: var(--neon-green);
      color: black;
      font-weight: bold;
      border-color: var(--neon-green);
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0px); }
    }
  </style>
</head>
<body class="bg-gaming-bg text-white min-h-screen">
  
  <!-- Navigation Header -->
  <nav class="bg-black bg-opacity-60 backdrop-blur-md border-b border-gaming-accent border-opacity-20 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <a href="index.html" onclick="handleNavigation(event, 'index.html')" class="text-2xl font-bold text-gaming-accent flex items-center space-x-2 hover:text-green-400 transition-colors">
              <span class="animate-pulse">üéÆ</span>
              <span>MLG.clan</span>
            </a>
          </div>
          <div class="hidden md:block ml-10">
            <div class="flex items-baseline space-x-4">
              <a href="index.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-gaming-accent hover:bg-gaming-surface transition-colors" onclick="handleNavigation(event, 'index.html')">Dashboard</a>
              <a href="voting.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-gaming-accent hover:bg-gaming-surface transition-colors" onclick="handleNavigation(event, 'voting.html')">Vote Vault</a>
              <a href="clans.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium bg-gaming-purple text-white transition-colors" onclick="handleNavigation(event, 'clans.html')">Clans</a>
              <a href="content.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-gaming-accent hover:bg-gaming-surface transition-colors" onclick="handleNavigation(event, 'content.html')">Content Hub</a>
              <a href="dao.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-gaming-accent hover:bg-gaming-surface transition-colors" onclick="handleNavigation(event, 'dao.html')">DAO</a>
              <a href="analytics.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-gaming-accent hover:bg-gaming-surface transition-colors" onclick="handleNavigation(event, 'analytics.html')">Analytics</a>
            </div>
          </div>
        </div>
        
        <div class="flex items-center space-x-4">
          <!-- System Status -->
          <div id="system-status" class="flex items-center space-x-2">
            <div class="status-online">
              <i data-lucide="activity" class="w-4 h-4 text-gaming-accent"></i>
            </div>
            <span class="text-sm text-gaming-accent font-medium">All Systems Online</span>
          </div>
          
          <!-- Wallet Connection -->
          <button id="wallet-connect" class="bg-gaming-purple hover:bg-purple-600 px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2">
            <i data-lucide="wallet" class="w-4 h-4"></i>
            <span>Connect Phantom</span>
          </button>
          
          <!-- User Info (Hidden by default) -->
          <div id="user-info" class="hidden flex items-center space-x-3">
            <div class="flex items-center space-x-2 bg-gaming-surface px-3 py-1 rounded-lg">
              <div class="w-6 h-6 bg-gradient-to-r from-gaming-accent to-gaming-blue rounded-full"></div>
              <span id="user-address" class="text-sm font-mono"></span>
            </div>
            <div class="text-right">
              <div class="text-xs text-gray-400">MLG Balance</div>
              <div id="mlg-balance" class="text-sm font-bold text-gaming-yellow">0</div>
            </div>
            <a href="profile.html" onclick="handleNavigation(event, 'profile.html')" class="text-gray-300 hover:text-gaming-accent transition-colors">
              <i data-lucide="user" class="w-5 h-5"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Clan Hub Header -->
  <section class="relative py-16 overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-r from-gaming-bg via-gaming-surface to-gaming-bg opacity-50"></div>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="text-5xl font-bold mb-6 text-gaming-purple animate-float">
        üèõÔ∏è Clan Hub
      </h1>
      <p class="text-xl text-gray-300 mb-8 max-w-3xl mx-auto">
        Create and manage gaming clans with token staking, governance, and competitive leaderboards.
      </p>
      
      <!-- Clan Stats -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
        <div class="card-glow rounded-lg p-6">
          <div class="text-3xl font-bold text-gaming-purple" id="total-clans">2,847</div>
          <div class="text-sm text-gray-400">Total Clans</div>
        </div>
        <div class="card-glow rounded-lg p-6">
          <div class="text-3xl font-bold text-gaming-yellow" id="staked-mlg">12.4M</div>
          <div class="text-sm text-gray-400">Staked MLG</div>
        </div>
        <div class="card-glow rounded-lg p-6">
          <div class="text-3xl font-bold text-gaming-blue" id="active-tournaments">23</div>
          <div class="text-sm text-gray-400">Active Tournaments</div>
        </div>
        <div class="card-glow rounded-lg p-6">
          <div class="text-3xl font-bold text-gaming-accent" id="clan-members">47,892</div>
          <div class="text-sm text-gray-400">Total Members</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="py-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- User's Clan -->
      <div class="mb-12">
        <h2 class="text-3xl font-bold text-gaming-purple mb-8 text-center">Your Clan</h2>
        <div class="clan-card rounded-xl p-8">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Clan Info -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-r from-gaming-purple to-gaming-blue rounded-full mx-auto mb-4 flex items-center justify-center">
                <i data-lucide="crown" class="w-12 h-12 text-white"></i>
              </div>
              <h3 class="text-2xl font-bold text-gaming-purple mb-2">MLG Elite</h3>
              <p class="text-gaming-yellow font-medium mb-4">Diamond Tier</p>
              <div class="inline-flex items-center space-x-2 bg-gaming-accent bg-opacity-20 px-4 py-2 rounded-full">
                <i data-lucide="shield" class="w-4 h-4 text-gaming-accent"></i>
                <span class="text-gaming-accent font-bold">Co-Leader</span>
              </div>
            </div>

            <!-- Clan Stats -->
            <div class="space-y-4">
              <h4 class="text-xl font-bold text-white mb-4">Clan Statistics</h4>
              <div class="space-y-3">
                <div class="flex justify-between items-center">
                  <span class="text-gray-300">Members</span>
                  <span class="text-gaming-accent font-bold">47/50</span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-300">Global Rank</span>
                  <span class="text-gaming-yellow font-bold">#12</span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-300">Staked MLG</span>
                  <span class="text-gaming-blue font-bold">125,000</span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-300">Tournament Wins</span>
                  <span class="text-gaming-purple font-bold">18</span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-gray-300">Weekly Points</span>
                  <span class="text-gaming-accent font-bold">892,471</span>
                </div>
              </div>
            </div>

            <!-- Clan Actions -->
            <div class="space-y-4">
              <h4 class="text-xl font-bold text-white mb-4">Clan Actions</h4>
              <button class="w-full bg-gaming-purple hover:bg-purple-600 px-6 py-3 rounded-lg font-bold transition-colors">
                Manage Clan
              </button>
              <button class="w-full bg-gaming-blue hover:bg-blue-600 px-6 py-3 rounded-lg font-bold transition-colors">
                View Members
              </button>
              <button class="w-full bg-gaming-yellow hover:bg-yellow-500 text-black px-6 py-3 rounded-lg font-bold transition-colors">
                Clan Treasury
              </button>
              <button class="w-full bg-gaming-accent hover:bg-green-400 text-black px-6 py-3 rounded-lg font-bold transition-colors">
                Invite Players
              </button>
            </div>

          </div>
        </div>
      </div>

      <!-- Clan Leaderboard -->
      <div class="mb-12">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-gaming-accent">Global Clan Leaderboard</h2>
          <div class="flex space-x-2">
            <button class="bg-gaming-accent text-black px-4 py-2 rounded-lg text-sm font-bold">
              This Week
            </button>
            <button class="bg-gaming-surface hover:bg-gaming-blue px-4 py-2 rounded-lg text-sm transition-colors">
              All Time
            </button>
          </div>
        </div>
        
        <!-- Clan Search -->
        <div class="mb-6">
          <div class="relative">
            <input 
              id="clan-search" 
              type="text" 
              placeholder="Search clans by name, tag, or founder..." 
              class="w-full bg-gaming-surface border border-gray-600 rounded-lg px-4 py-3 pl-12 text-white focus:ring-2 focus:ring-gaming-accent focus:border-transparent transition-all"
            >
            <i data-lucide="search" class="w-5 h-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <div id="clan-search-results-count" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-sm text-gray-400 hidden">
              <span id="clan-results-count">0</span> clans found
            </div>
          </div>
          
          <!-- Clan Search Filters -->
          <div class="flex flex-wrap gap-2 mt-3">
            <button class="clan-filter active px-3 py-1 bg-gaming-accent text-black rounded-full text-sm" data-filter="all">All Clans</button>
            <button class="clan-filter px-3 py-1 bg-gaming-surface text-gray-400 rounded-full text-sm hover:text-gaming-accent" data-filter="recruiting">Recruiting</button>
            <button class="clan-filter px-3 py-1 bg-gaming-surface text-gray-400 rounded-full text-sm hover:text-gaming-accent" data-filter="competitive">Competitive</button>
            <button class="clan-filter px-3 py-1 bg-gaming-surface text-gray-400 rounded-full text-sm hover:text-gaming-accent" data-filter="casual">Casual</button>
            <button class="clan-filter px-3 py-1 bg-gaming-surface text-gray-400 rounded-full text-sm hover:text-gaming-accent" data-filter="top-100">Top 100</button>
          </div>
        </div>

        <div class="card-glow rounded-xl p-8">
          <div class="space-y-4" id="leaderboard">
            
            <!-- Rank 1 -->
            <div class="clan-item flex items-center justify-between p-4 bg-gradient-to-r from-yellow-900 to-yellow-800 rounded-lg border-2 border-yellow-400" data-name="mlg elite" data-tag="MLG" data-founder="founder" data-type="competitive">
              <div class="flex items-center space-x-4">
                <div class="text-3xl">üëë</div>
                <span class="text-2xl font-bold text-yellow-400">#1</span>
                <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                  <i data-lucide="flame" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                  <h3 class="text-xl font-bold text-white">Phoenix Rising</h3>
                  <p class="text-sm text-yellow-200">Legendary Tier ‚Ä¢ 50 members</p>
                </div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold text-yellow-400">1,247,892</div>
                <div class="text-sm text-yellow-200">points</div>
              </div>
            </div>

            <!-- Rank 2 -->
            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-700 to-gray-600 rounded-lg border border-gray-400">
              <div class="flex items-center space-x-4">
                <span class="text-2xl font-bold text-gray-300">#2</span>
                <div class="w-12 h-12 bg-gradient-to-r from-gray-400 to-gray-600 rounded-full flex items-center justify-center">
                  <i data-lucide="sword" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                  <h3 class="text-xl font-bold text-white">Digital Warriors</h3>
                  <p class="text-sm text-gray-300">Diamond Tier ‚Ä¢ 48 members</p>
                </div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold text-gray-300">1,156,234</div>
                <div class="text-sm text-gray-400">points</div>
              </div>
            </div>

            <!-- Your Clan -->
            <div class="flex items-center justify-between p-4 bg-gaming-purple bg-opacity-20 rounded-lg border-2 border-gaming-purple">
              <div class="flex items-center space-x-4">
                <span class="text-2xl font-bold text-gaming-yellow">#12</span>
                <div class="w-12 h-12 bg-gradient-to-r from-gaming-purple to-gaming-blue rounded-full flex items-center justify-center">
                  <i data-lucide="crown" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                  <h3 class="text-xl font-bold text-white">MLG Elite</h3>
                  <p class="text-sm text-gaming-purple">Diamond Tier ‚Ä¢ 47 members ‚Ä¢ Your Clan</p>
                </div>
              </div>
              <div class="text-right">
                <div class="text-2xl font-bold text-gaming-accent">892,471</div>
                <div class="text-sm text-gaming-purple">points</div>
              </div>
            </div>

            <!-- More clans -->
            <div class="space-y-3">
              <div class="flex items-center justify-between p-3 bg-gaming-surface rounded-lg">
                <div class="flex items-center space-x-3">
                  <span class="text-gray-400 font-bold">#3</span>
                  <div class="w-8 h-8 bg-gradient-to-r from-orange-500 to-red-600 rounded-full"></div>
                  <span class="text-white">Cyber Legends</span>
                </div>
                <span class="text-gaming-accent font-bold">1,089,567</span>
              </div>
              <div class="flex items-center justify-between p-3 bg-gaming-surface rounded-lg">
                <div class="flex items-center space-x-3">
                  <span class="text-gray-400 font-bold">#4</span>
                  <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-600 rounded-full"></div>
                  <span class="text-white">Quantum Gamers</span>
                </div>
                <span class="text-gaming-accent font-bold">987,234</span>
              </div>
              <div class="flex items-center justify-between p-3 bg-gaming-surface rounded-lg">
                <div class="flex items-center space-x-3">
                  <span class="text-gray-400 font-bold">#5</span>
                  <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full"></div>
                  <span class="text-white">Nova Squadron</span>
                </div>
                <span class="text-gaming-accent font-bold">923,891</span>
              </div>
            </div>

          </div>
          
          <div class="mt-8 text-center">
            <button class="bg-gaming-surface hover:bg-gaming-blue px-8 py-3 rounded-lg font-bold transition-colors">
              View Full Leaderboard
            </button>
          </div>
        </div>
      </div>

      <!-- Create or Join Clan -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        <!-- Create New Clan -->
        <div class="card-glow rounded-xl p-8">
          <div class="text-center mb-6">
            <div class="w-16 h-16 bg-gaming-accent rounded-full flex items-center justify-center mx-auto mb-4">
              <i data-lucide="plus" class="w-8 h-8 text-black"></i>
            </div>
            <h3 class="text-2xl font-bold text-gaming-accent mb-2">Create New Clan</h3>
            <p class="text-gray-400">Start your own gaming community</p>
          </div>
          
          <form id="create-clan-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Clan Name</label>
              <input id="clan-name" name="clanName" type="text" placeholder="Enter clan name..." required minlength="3" maxlength="20" class="w-full bg-gaming-surface border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-gaming-accent focus:border-transparent">
              <div class="char-counter-clan-name text-xs text-gray-400 mt-1">
                <span class="current">0</span>/<span class="max">20</span> characters
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Clan Tag</label>
              <input id="clan-tag" name="clanTag" type="text" placeholder="TAG" required minlength="2" maxlength="5" class="w-full bg-gaming-surface border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-gaming-accent focus:border-transparent" style="text-transform: uppercase;">
              <div class="char-counter-clan-tag text-xs text-gray-400 mt-1">
                <span class="current">0</span>/<span class="max">5</span> characters
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Description (Optional)</label>
              <textarea id="clan-description" name="description" placeholder="Describe your clan..." rows="3" maxlength="200" class="w-full bg-gaming-surface border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-gaming-accent focus:border-transparent resize-none"></textarea>
              <div class="char-counter-clan-description text-xs text-gray-400 mt-1">
                <span class="current">0</span>/<span class="max">200</span> characters
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Privacy Setting</label>
              <select id="clan-privacy" name="privacy" required class="w-full bg-gaming-surface border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-gaming-accent focus:border-transparent">
                <option value="public">üåç Public - Anyone can join</option>
                <option value="invite-only">üîí Invite Only - Requires invitation</option>
                <option value="private">üö´ Private - Closed membership</option>
              </select>
            </div>
            
            <div class="bg-gaming-surface rounded-lg p-4">
              <h4 class="font-bold text-gaming-accent mb-2">Requirements</h4>
              <ul class="space-y-1 text-sm text-gray-300" id="clan-requirements">
                <li id="wallet-check">‚è≥ Connect Phantom Wallet</li>
                <li id="balance-check">‚è≥ Minimum 1,000 MLG tokens</li>
                <li id="name-check">‚è≥ Valid clan name (3-20 characters)</li>
                <li id="tag-check">‚è≥ Unique clan tag</li>
              </ul>
            </div>
            
            <button type="submit" id="create-clan-btn" class="w-full bg-gaming-accent hover:bg-green-400 text-black px-8 py-3 rounded-lg font-bold text-lg transition-colors disabled:bg-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed" disabled>
              Create Clan (1,000 MLG)
            </button>
          </form>
        </div>

        <!-- Join Existing Clan -->
        <div class="card-glow rounded-xl p-8">
          <div class="text-center mb-6">
            <div class="w-16 h-16 bg-gaming-blue rounded-full flex items-center justify-center mx-auto mb-4">
              <i data-lucide="users" class="w-8 h-8 text-white"></i>
            </div>
            <h3 class="text-2xl font-bold text-gaming-blue mb-2">Browse Clans</h3>
            <p class="text-gray-400">Find the perfect clan for you</p>
          </div>
          
          <div class="space-y-4">
            <div class="bg-gaming-surface rounded-lg p-4">
              <h4 class="font-bold text-white mb-2">Popular Clans</h4>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span class="text-gray-300">Recruiting Now</span>
                  <span class="text-gaming-blue font-bold">247 clans</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-300">No Requirements</span>
                  <span class="text-gaming-accent font-bold">89 clans</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-300">Beginner Friendly</span>
                  <span class="text-gaming-yellow font-bold">156 clans</span>
                </div>
              </div>
            </div>
            
            <button id="browse-clans-btn" class="w-full bg-gaming-blue hover:bg-blue-600 px-6 py-3 rounded-lg font-bold transition-colors">
              Browse All Clans
            </button>
          </div>
        </div>

      </div>

    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-black bg-opacity-80 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <a href="index.html" onclick="handleNavigation(event, 'index.html')" class="text-2xl font-bold mb-4 text-gaming-accent hover:text-green-400 transition-colors inline-block">üéÆ MLG.clan</a>
        <p class="text-gray-400 mb-6">The future of gaming communities is here.</p>
        <div class="flex justify-center space-x-8 text-sm text-gray-500">
          <span>Web3 Native</span>
          <span>‚Ä¢</span>
          <span>Enterprise Ready</span>
          <span>‚Ä¢</span>
          <span>Community Governed</span>
          <span>‚Ä¢</span>
          <span>100% Complete</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- Clan Browser Modal -->
  <div id="clan-browser-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-gaming-surface border border-gaming-accent rounded-lg p-6 max-w-4xl mx-4 max-h-[90vh] overflow-hidden">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gaming-blue">üèõÔ∏è Clan Browser</h3>
        <button id="close-browser-modal" class="text-gray-400 hover:text-white text-2xl">&times;</button>
      </div>
      
      <!-- Search and Filters -->
      <div class="mb-6 space-y-4">
        <div class="flex space-x-4">
          <input type="text" id="clan-search-input" placeholder="Search clans..." class="flex-1 bg-gaming-bg border border-gaming-accent border-opacity-20 rounded-lg px-4 py-2 text-white focus:border-gaming-accent focus:outline-none">
          <select id="clan-type-filter" class="bg-gaming-bg border border-gaming-accent border-opacity-20 rounded-lg px-4 py-2 text-white focus:border-gaming-accent focus:outline-none">
            <option value="all">All Types</option>
            <option value="competitive">Competitive</option>
            <option value="casual">Casual</option>
            <option value="recruiting">Recruiting</option>
          </select>
        </div>
        
        <div class="flex space-x-2 text-sm">
          <button class="clan-sort-btn active" data-sort="members">üë• Members</button>
          <button class="clan-sort-btn" data-sort="wins">üèÜ Wins</button>
          <button class="clan-sort-btn" data-sort="founded">üìÖ Founded</button>
          <button class="clan-sort-btn" data-sort="rating">‚≠ê Rating</button>
        </div>
      </div>
      
      <!-- Clan List -->
      <div class="max-h-96 overflow-y-auto space-y-3" id="clan-browser-list">
        <!-- Dynamic clan list will be populated here -->
      </div>
    </div>
  </div>

  <!-- Join Clan Confirmation Modal -->
  <div id="join-clan-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-gaming-surface border border-gaming-accent rounded-lg p-6 max-w-md mx-4">
      <div class="text-center">
        <h3 class="text-xl font-bold text-gaming-blue mb-4">üéØ Join Clan</h3>
        <div id="join-clan-info" class="mb-6">
          <!-- Clan info will be populated here -->
        </div>
        <div class="flex space-x-3">
          <button id="confirm-join-clan" class="flex-1 bg-gaming-blue hover:bg-blue-600 text-white px-4 py-2 rounded font-bold transition-colors">
            Join Clan
          </button>
          <button id="cancel-join-clan" class="flex-1 bg-gray-600 hover:bg-gray-500 px-4 py-2 rounded font-bold transition-colors">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Initialize clan platform
    class ClanPlatform {
      constructor() {
        this.stats = {
          totalClans: 2847,
          stakedMLG: 12400000,
          activeTournaments: 23,
          clanMembers: 47892
        };
        this.clanData = null;
        this.init();
      }
      
      async init() {
        console.log('üèõÔ∏è Initializing Clan Platform...');
        
        this.initializeUI();
        this.setupEventListeners();
        
        // Load data from API
        await this.loadClanData();
        
        this.startRealTimeUpdates();
        console.log('‚úÖ Clan Platform initialized successfully!');
      }
      
      initializeUI() {
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      }
      
      setupEventListeners() {
        // Clan creation form
        const createClanForm = document.getElementById('create-clan-form');
        if (createClanForm) {
          createClanForm.addEventListener('submit', (e) => {
            e.preventDefault();
            this.handleClanCreation(e);
          });
        }
        
        // Real-time validation for clan form fields
        const clanNameInput = document.getElementById('clan-name');
        if (clanNameInput) {
          clanNameInput.addEventListener('input', (e) => {
            this.updateCharacterCounter('clan-name', e.target.value, 20);
            this.validateClanName(e.target.value);
          });
        }
        
        const clanTagInput = document.getElementById('clan-tag');
        if (clanTagInput) {
          clanTagInput.addEventListener('input', (e) => {
            e.target.value = e.target.value.toUpperCase();
            this.updateCharacterCounter('clan-tag', e.target.value, 5);
            this.validateClanTag(e.target.value);
          });
        }
        
        const clanDescInput = document.getElementById('clan-description');
        if (clanDescInput) {
          clanDescInput.addEventListener('input', (e) => {
            this.updateCharacterCounter('clan-description', e.target.value, 200);
          });
        }
        
        // Other clan actions
        document.querySelectorAll('button').forEach(btn => {
          if (!btn.closest('#create-clan-form')) { // Skip form buttons
            btn.addEventListener('click', () => {
              if (btn.textContent.includes('Browse')) {
                this.showClanBrowser();
              } else if (btn.textContent.includes('Manage') || btn.textContent.includes('Members') || btn.textContent.includes('Treasury') || btn.textContent.includes('Invite')) {
                this.showNotification('‚öôÔ∏è Clan management features coming soon!', 'info');
              }
            });
          }
        });
        
        // Check wallet connection and balance periodically
        this.checkWalletStatus();
        setInterval(() => this.checkWalletStatus(), 5000);
        
        // Clan search functionality
        const clanSearchInput = document.getElementById('clan-search');
        if (clanSearchInput) {
          clanSearchInput.addEventListener('input', (e) => {
            this.performClanSearch(e.target.value);
          });
        }
        
        // Clan search filters
        document.querySelectorAll('.clan-filter').forEach(filter => {
          filter.addEventListener('click', (e) => {
            this.setActiveClanFilter(e.target);
            this.performClanSearch(clanSearchInput ? clanSearchInput.value : '');
          });
        });
      }
      
      async loadClanData() {
        try {
          console.log('üìä Loading clan data from API...');
          
          // Show loading state
          window.mlgApi?.showLoading('main', {
            message: 'Loading clan data...',
            type: 'dashboard'
          });
          
          // Load clan data from API
          const response = await window.mlgApi.getClans();
          
          if (response.success) {
            this.clanData = response;
            
            // Update stats from API data
            this.stats = {
              totalClans: response.leaderboard?.length || this.stats.totalClans,
              stakedMLG: response.user_clan?.staked_mlg || this.stats.stakedMLG,
              activeTournaments: 23, // This would come from tournaments API
              clanMembers: response.user_clan?.members || this.stats.clanMembers
            };
            
            // Update display
            this.updateStatsDisplay();
            
            // Update user clan info
            this.updateUserClanInfo(response.user_clan);
            
            // Update leaderboard
            this.updateLeaderboard(response.leaderboard);
            
            console.log('‚úÖ Clan data loaded from API');
          } else {
            throw new Error('API response not successful');
          }
          
        } catch (error) {
          console.error('Failed to load clan data:', error);
          
          // Show error notification
          this.showNotification('Failed to load clan data. Using fallback.', 'warning');
          
          // Use fallback data
          this.updateStatsDisplay();
        } finally {
          // Hide loading state
          window.mlgApi?.hideLoading('main');
        }
      }
      
      updateStatsDisplay() {
        // Update DOM with current stats
        const elements = {
          'total-clans': this.stats.totalClans.toLocaleString(),
          'staked-mlg': (this.stats.stakedMLG / 1000000).toFixed(1) + 'M',
          'active-tournaments': this.stats.activeTournaments,
          'clan-members': this.stats.clanMembers.toLocaleString()
        };
        
        Object.entries(elements).forEach(([id, value]) => {
          const element = document.getElementById(id);
          if (element) {
            element.textContent = value;
            // Add pulse effect for updates
            element.classList.add('animate-pulse-neon');
            setTimeout(() => {
              element.classList.remove('animate-pulse-neon');
            }, 1000);
          }
        });
      }
      
      updateUserClanInfo(userClan) {
        if (!userClan) return;
        
        console.log('üèõÔ∏è Updating user clan info:', userClan);
        
        // Update user clan display elements if they exist
        // This would update clan name, rank, members, etc.
        const clanNameElements = document.querySelectorAll('[data-clan="name"]');
        const clanRankElements = document.querySelectorAll('[data-clan="rank"]');
        const clanMembersElements = document.querySelectorAll('[data-clan="members"]');
        
        clanNameElements.forEach(el => el.textContent = userClan.name || 'MLG Elite');
        clanRankElements.forEach(el => el.textContent = userClan.rank || '12');
        clanMembersElements.forEach(el => el.textContent = `${userClan.members}/${userClan.max_members}` || '47/50');
      }
      
      updateLeaderboard(leaderboard) {
        if (!leaderboard || leaderboard.length === 0) {
          // Use fallback dynamic data if no API data
          leaderboard = this.generateFallbackLeaderboard();
        }
        
        console.log('üìà Updating clan leaderboard:', leaderboard);
        
        const leaderboardContainer = document.getElementById('leaderboard');
        if (!leaderboardContainer) return;
        
        // Clear existing content
        leaderboardContainer.innerHTML = '';
        
        // Generate dynamic leaderboard entries
        leaderboard.forEach((clan, index) => {
          const rank = index + 1;
          const rankClass = rank === 1 ? 'text-yellow-400' : 
                           rank === 2 ? 'text-gray-300' : 
                           rank === 3 ? 'text-amber-600' : 'text-gaming-blue';
          const bgClass = rank === 1 ? 'from-yellow-900 to-yellow-800 border-2 border-yellow-400' :
                         rank === 2 ? 'from-gray-800 to-gray-700 border-2 border-gray-300' :
                         rank === 3 ? 'from-amber-900 to-amber-800 border-2 border-amber-600' :
                         'from-gaming-surface to-gaming-surface';
          
          const clanElement = document.createElement('div');
          clanElement.className = `clan-item flex items-center justify-between p-4 bg-gradient-to-r ${bgClass} rounded-lg hover:bg-opacity-80 transition-all`;
          clanElement.dataset.name = clan.name.toLowerCase();
          clanElement.dataset.tag = clan.tag.toLowerCase();
          clanElement.dataset.founder = clan.founder.toLowerCase();
          clanElement.dataset.type = clan.type.toLowerCase();
          
          clanElement.innerHTML = `
            <div class="flex items-center space-x-4">
              ${rank === 1 ? '<div class="text-3xl">üëë</div>' : ''}
              <span class="text-2xl font-bold ${rankClass}">#${rank}</span>
              <div class="w-12 h-12 bg-gradient-to-r ${this.getClanGradient(clan.tag)} rounded-full flex items-center justify-center">
                <span class="font-bold text-white text-sm">${clan.tag}</span>
              </div>
              <div>
                <h3 class="font-bold text-white">${clan.name}</h3>
                <p class="text-sm text-gray-400">Founded by ${clan.founder} ‚Ä¢ ${clan.members}/${clan.maxMembers} members${clan.recruiting ? ' ‚Ä¢ Recruiting' : ''}</p>
              </div>
            </div>
            <div class="flex items-center space-x-6">
              <div class="text-center">
                <div class="font-bold text-gaming-accent">${this.formatNumber(clan.mlgStaked)}</div>
                <div class="text-xs text-gray-400">MLG Staked</div>
              </div>
              <div class="text-center">
                <div class="font-bold text-gaming-blue">${clan.totalVotes}</div>
                <div class="text-xs text-gray-400">Total Votes</div>
              </div>
              <div class="text-center">
                <div class="font-bold text-gaming-purple">${clan.weeklyScore}</div>
                <div class="text-xs text-gray-400">Weekly Score</div>
              </div>
              <button class="bg-gaming-accent hover:bg-green-400 text-black px-4 py-2 rounded-lg font-medium transition-colors">
                ${clan.canJoin ? 'Join' : 'View'}
              </button>
            </div>
          `;
          
          leaderboardContainer.appendChild(clanElement);
        });
        
        console.log(`‚úÖ Updated leaderboard with ${leaderboard.length} clans`);
      }
      
      generateFallbackLeaderboard() {
        // Generate dynamic leaderboard data with realistic variations
        const baseClans = [
          { name: 'MLG Elite', tag: 'MLG', founder: 'Founder', type: 'competitive', recruiting: false },
          { name: 'Shadow Legends', tag: 'SHDW', founder: 'ShadowMaster', type: 'competitive', recruiting: true },
          { name: 'Apex Warriors', tag: 'APEX', founder: 'ApexKing', type: 'competitive', recruiting: false },
          { name: 'Casual Gamers', tag: 'CAZL', founder: 'ChillPlayer', type: 'casual', recruiting: true },
          { name: 'Pro Esports', tag: 'PROE', founder: 'ProGamer', type: 'competitive', recruiting: false },
          { name: 'Night Raiders', tag: 'NGHT', founder: 'NightOwl', type: 'casual', recruiting: true },
          { name: 'Elite Force', tag: 'ELIT', founder: 'ForceLeader', type: 'competitive', recruiting: false },
          { name: 'Gaming Squad', tag: 'GMSQ', founder: 'SquadLeader', type: 'casual', recruiting: true }
        ];
        
        return baseClans.map((clan, index) => ({
          ...clan,
          rank: index + 1,
          members: 35 + Math.floor(Math.random() * 15),
          maxMembers: 50,
          mlgStaked: (2500000 - (index * 300000)) + Math.floor(Math.random() * 100000),
          totalVotes: (900 - (index * 80)) + Math.floor(Math.random() * 50),
          weeklyScore: (1000 - (index * 100)) + Math.floor(Math.random() * 80),
          canJoin: clan.recruiting && Math.random() > 0.3,
          lastActive: this.getRandomTime()
        }));
      }
      
      getClanGradient(tag) {
        const gradients = {
          'MLG': 'from-yellow-400 to-orange-500',
          'SHDW': 'from-purple-600 to-black',
          'APEX': 'from-red-500 to-pink-600',
          'CAZL': 'from-blue-400 to-cyan-500',
          'PROE': 'from-green-500 to-teal-600',
          'NGHT': 'from-indigo-600 to-purple-800',
          'ELIT': 'from-gaming-accent to-green-400',
          'GMSQ': 'from-gaming-blue to-gaming-purple'
        };
        return gradients[tag] || 'from-gaming-surface to-gaming-blue';
      }
      
      formatNumber(num) {
        if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
        if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
        return num.toString();
      }
      
      getRandomTime() {
        const times = ['5 mins ago', '1 hour ago', '3 hours ago', '1 day ago', '2 days ago'];
        return times[Math.floor(Math.random() * times.length)];
      }
      
      startRealTimeUpdates() {
        // Start real-time updates using the API client
        console.log('üîÑ Starting real-time clan updates...');
        
        // Initialize with fallback data and start dynamic updates
        this.updateLeaderboard(null); // This will trigger fallback generation
        
        // Set up periodic leaderboard refresh for dynamic feel
        this.leaderboardUpdateInterval = setInterval(() => {
          console.log('üîÑ Refreshing leaderboard with dynamic data...');
          
          // Add some realistic variations to make it feel live
          const currentLeaderboard = this.generateFallbackLeaderboard();
          
          // Occasionally shuffle ranks slightly for realism
          if (Math.random() < 0.3) {
            this.shuffleLeaderboardSlightly(currentLeaderboard);
          }
          
          this.updateLeaderboard(currentLeaderboard);
          this.updateStatsWithVariation();
        }, 10000); // Update every 10 seconds
        
        // Try real API updates if available
        if (window.mlgApi?.startRealTimeUpdates) {
          window.mlgApi.startRealTimeUpdates('/clans', (data) => {
            if (data.success) {
              this.clanData = data;
              this.updateUserClanInfo(data.user_clan);
              this.updateLeaderboard(data.leaderboard);
              
              // Update stats from API data
              this.stats.totalClans = data.leaderboard?.length || this.stats.totalClans;
              this.stats.clanMembers = data.user_clan?.members || this.stats.clanMembers;
              this.updateStatsDisplay();
            }
          }, 15000);
        }
      }
      
      shuffleLeaderboardSlightly(leaderboard) {
        // Occasionally swap adjacent clans for realism
        if (leaderboard.length > 3 && Math.random() < 0.5) {
          const swapIndex = 3 + Math.floor(Math.random() * (leaderboard.length - 4));
          [leaderboard[swapIndex], leaderboard[swapIndex + 1]] = 
          [leaderboard[swapIndex + 1], leaderboard[swapIndex]];
          
          // Update ranks
          leaderboard.forEach((clan, index) => {
            clan.rank = index + 1;
          });
        }
      }
      
      updateStatsWithVariation() {
        // Add small variations to stats for dynamic feel
        const variations = {
          totalClans: Math.floor(Math.random() * 10) - 5,
          stakedMLG: Math.floor(Math.random() * 100000) - 50000,
          activeTournaments: Math.floor(Math.random() * 3) - 1,
          clanMembers: Math.floor(Math.random() * 50) - 25
        };
        
        this.stats.totalClans = Math.max(2800, this.stats.totalClans + variations.totalClans);
        this.stats.stakedMLG = Math.max(12000000, this.stats.stakedMLG + variations.stakedMLG);
        this.stats.activeTournaments = Math.max(20, this.stats.activeTournaments + variations.activeTournaments);
        this.stats.clanMembers = Math.max(47000, this.stats.clanMembers + variations.clanMembers);
        
        this.updateStatsDisplay();
      }
      
      showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 transition-all transform translate-x-full ${
          type === 'success' ? 'bg-gaming-accent text-black' :
          type === 'error' ? 'bg-gaming-red' :
          type === 'warning' ? 'bg-gaming-yellow text-black' :
          'bg-gaming-blue'
        }`;
        
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.remove('translate-x-full');
        }, 100);
        
        setTimeout(() => {
          notification.classList.add('translate-x-full');
          setTimeout(() => {
            if (document.body.contains(notification)) {
              document.body.removeChild(notification);
            }
          }, 300);
        }, 4000);
      }
      
      updateCharacterCounter(fieldId, value, maxLength) {
        const counter = document.querySelector(`.char-counter-${fieldId} .current`);
        if (counter) {
          counter.textContent = value.length;
          
          // Update color based on remaining characters
          const remaining = maxLength - value.length;
          const counterParent = counter.parentElement;
          
          if (remaining < 0) {
            counterParent.className = `char-counter-${fieldId} text-xs text-gaming-red mt-1`;
          } else if (remaining < maxLength * 0.1) {
            counterParent.className = `char-counter-${fieldId} text-xs text-gaming-yellow mt-1`;
          } else {
            counterParent.className = `char-counter-${fieldId} text-xs text-gray-400 mt-1`;
          }
        }
      }
      
      validateClanName(name) {
        const nameCheck = document.getElementById('name-check');
        if (name.length >= 3 && name.length <= 20) {
          nameCheck.innerHTML = '‚úÖ Valid clan name (3-20 characters)';
          nameCheck.className = 'text-gaming-accent';
        } else {
          nameCheck.innerHTML = '‚è≥ Valid clan name (3-20 characters)';
          nameCheck.className = 'text-gray-300';
        }
        this.updateCreateButtonState();
      }
      
      validateClanTag(tag) {
        const tagCheck = document.getElementById('tag-check');
        if (tag.length >= 2 && tag.length <= 5 && /^[A-Z0-9]+$/.test(tag)) {
          // Check if tag is unique (for demo, just check against common tags)
          const commonTags = ['MLG', 'PRO', 'GOAT', 'ELITE', 'APEX'];
          if (commonTags.includes(tag)) {
            tagCheck.innerHTML = '‚ùå Tag already taken';
            tagCheck.className = 'text-gaming-red';
          } else {
            tagCheck.innerHTML = '‚úÖ Unique clan tag';
            tagCheck.className = 'text-gaming-accent';
          }
        } else {
          tagCheck.innerHTML = '‚è≥ Unique clan tag';
          tagCheck.className = 'text-gray-300';
        }
        this.updateCreateButtonState();
      }
      
      checkWalletStatus() {
        const walletCheck = document.getElementById('wallet-check');
        const balanceCheck = document.getElementById('balance-check');
        
        // Check wallet connection
        let walletConnected = false;
        let hasBalance = false;
        
        if (window.phantom && window.phantom.solana && window.phantom.solana.isConnected) {
          walletConnected = true;
          walletCheck.innerHTML = '‚úÖ Connect Phantom Wallet';
          walletCheck.className = 'text-gaming-accent';
          
          // Check balance (mock for demo)
          hasBalance = true; // Assume user has balance for demo
          balanceCheck.innerHTML = '‚úÖ Minimum 1,000 MLG tokens';
          balanceCheck.className = 'text-gaming-accent';
        } else {
          walletCheck.innerHTML = '‚ùå Connect Phantom Wallet';
          walletCheck.className = 'text-gaming-red';
          balanceCheck.innerHTML = '‚è≥ Minimum 1,000 MLG tokens';
          balanceCheck.className = 'text-gray-300';
        }
        
        this.updateCreateButtonState();
      }
      
      updateCreateButtonState() {
        const createBtn = document.getElementById('create-clan-btn');
        const nameValid = document.getElementById('name-check').className.includes('gaming-accent');
        const tagValid = document.getElementById('tag-check').className.includes('gaming-accent');
        const walletValid = document.getElementById('wallet-check').className.includes('gaming-accent');
        const balanceValid = document.getElementById('balance-check').className.includes('gaming-accent');
        
        if (nameValid && tagValid && walletValid && balanceValid) {
          createBtn.disabled = false;
          createBtn.className = createBtn.className.replace('disabled:bg-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed', '');
        } else {
          createBtn.disabled = true;
        }
      }
      
      async handleClanCreation(event) {
        try {
          const formData = new FormData(event.target);
          const clanData = {
            name: formData.get('clanName'),
            tag: formData.get('clanTag'),
            description: formData.get('description') || '',
            privacy: formData.get('privacy')
          };
          
          // Show loading state
          const createBtn = document.getElementById('create-clan-btn');
          const originalContent = createBtn.innerHTML;
          createBtn.disabled = true;
          createBtn.innerHTML = '<i class="animate-spin">‚è≥</i> Creating Clan...';
          
          // Submit clan creation
          let result;
          if (window.MLGApiClient && typeof window.MLGApiClient.createClan === 'function') {
            result = await window.MLGApiClient.createClan(clanData);
          } else {
            result = await this.fallbackClanCreation(clanData);
          }
          
          if (result && result.success) {
            // Success
            this.showNotification('üèõÔ∏è Clan created successfully!', 'success');
            event.target.reset();
            this.resetCharacterCounters();
            
            // Refresh clan data
            await this.loadClanData();
          }
          
        } catch (error) {
          console.error('Clan creation failed:', error);
          this.showNotification('‚ùå Failed to create clan. Please try again.', 'error');
        } finally {
          // Restore button state
          const createBtn = document.getElementById('create-clan-btn');
          if (createBtn) {
            createBtn.disabled = false;
            createBtn.innerHTML = 'Create Clan (1,000 MLG)';
            this.updateCreateButtonState();
          }
        }
      }
      
      async fallbackClanCreation(clanData) {
        console.log('üîÑ Using fallback clan creation:', clanData);
        
        // Simulate API delay
        await new Promise(resolve => setTimeout(resolve, 3000));
        
        // Store clan in localStorage for demo
        const clans = JSON.parse(localStorage.getItem('mlg_clans') || '[]');
        const newClan = {
          ...clanData,
          id: Date.now(),
          created: new Date().toISOString(),
          members: 1,
          founder: 'current-user',
          treasury: 1000,
          rank: clans.length + 1
        };
        
        clans.push(newClan);
        localStorage.setItem('mlg_clans', JSON.stringify(clans));
        
        console.log('‚úÖ Clan stored locally for demo');
        return { success: true, clan: newClan };
      }
      
      resetCharacterCounters() {
        const counters = document.querySelectorAll('[class*="char-counter-"] .current');
        counters.forEach(counter => {
          counter.textContent = '0';
          counter.parentElement.className = counter.parentElement.className.replace(/text-gaming-(red|yellow)/, 'text-gray-400');
        });
      }
      
      showClanBrowser() {
        console.log('üèõÔ∏è Opening clan browser...');
        
        // Populate clan list
        this.populateClanBrowser();
        
        // Show modal
        document.getElementById('clan-browser-modal').classList.remove('hidden');
        
        // Set up modal event listeners
        this.setupClanBrowserEventListeners();
      }
      
      setupClanBrowserEventListeners() {
        // Close modal
        document.getElementById('close-browser-modal').onclick = () => this.closeClanBrowser();
        
        // Search functionality
        document.getElementById('clan-search-input').addEventListener('input', (e) => {
          this.filterClans(e.target.value);
        });
        
        // Type filter
        document.getElementById('clan-type-filter').addEventListener('change', (e) => {
          this.filterClans(document.getElementById('clan-search-input').value, e.target.value);
        });
        
        // Sort buttons
        document.querySelectorAll('.clan-sort-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.clan-sort-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            this.sortClans(btn.dataset.sort);
          });
        });
        
        // Join clan modal handlers
        document.getElementById('cancel-join-clan').onclick = () => this.closeJoinClanModal();
        document.getElementById('confirm-join-clan').onclick = () => this.confirmJoinClan();
        
        // Close on outside click
        document.getElementById('clan-browser-modal').addEventListener('click', (e) => {
          if (e.target.id === 'clan-browser-modal') {
            this.closeClanBrowser();
          }
        });
      }
      
      populateClanBrowser() {
        const clanList = document.getElementById('clan-browser-list');
        const clans = this.generateClanList();
        
        clanList.innerHTML = clans.map(clan => `
          <div class="clan-browser-item p-4 bg-gaming-bg rounded-lg border border-gaming-accent border-opacity-20 hover:border-opacity-40 transition-all" data-clan-id="${clan.id}">
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-4">
                <div class="w-12 h-12 bg-gradient-to-r ${clan.gradient} rounded-lg flex items-center justify-center">
                  <span class="text-lg font-bold text-white">${clan.tag}</span>
                </div>
                <div>
                  <h4 class="font-bold text-white">${clan.name}</h4>
                  <div class="flex items-center space-x-4 text-sm text-gray-400">
                    <span>üë• ${clan.members}/50</span>
                    <span>üèÜ ${clan.wins}W</span>
                    <span>‚≠ê ${clan.rating}</span>
                    <span class="text-${clan.recruiting ? 'green' : 'red'}-400">${clan.recruiting ? '‚úÖ Recruiting' : '‚ùå Closed'}</span>
                  </div>
                  <p class="text-xs text-gray-500 mt-1">${clan.description}</p>
                </div>
              </div>
              <div class="text-right">
                ${clan.recruiting ? 
                  `<button class="join-clan-btn bg-gaming-blue hover:bg-blue-600 px-4 py-2 rounded text-sm font-bold transition-colors" data-clan-id="${clan.id}">Join</button>` :
                  `<span class="text-gray-500 text-sm">Full</span>`
                }
              </div>
            </div>
          </div>
        `).join('');
        
        // Add join button event listeners
        document.querySelectorAll('.join-clan-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            const clanId = e.target.dataset.clanId;
            const clan = clans.find(c => c.id === clanId);
            this.showJoinClanModal(clan);
          });
        });
      }
      
      generateClanList() {
        return [
          { id: '1', name: 'Elite Gamers', tag: 'EG', members: 45, wins: 289, rating: 4.8, recruiting: true, description: 'Competitive Valorant and CS:GO clan', gradient: 'from-purple-500 to-pink-500' },
          { id: '2', name: 'Victory Squad', tag: 'VS', members: 38, wins: 156, rating: 4.5, recruiting: true, description: 'Multi-game casual and competitive', gradient: 'from-blue-500 to-cyan-500' },
          { id: '3', name: 'Apex Legends', tag: 'APX', members: 50, wins: 423, rating: 4.9, recruiting: false, description: 'Top-tier Apex Legends specialists', gradient: 'from-orange-500 to-red-500' },
          { id: '4', name: 'Fortnite Masters', tag: 'FM', members: 42, wins: 234, rating: 4.6, recruiting: true, description: 'Fortnite competitive and creative', gradient: 'from-green-500 to-blue-500' },
          { id: '5', name: 'Call of Duty Elite', tag: 'COD', members: 35, wins: 178, rating: 4.3, recruiting: true, description: 'Warzone and multiplayer focus', gradient: 'from-gray-500 to-gray-700' },
          { id: '6', name: 'Rocket League Pro', tag: 'RLP', members: 28, wins: 312, rating: 4.7, recruiting: true, description: 'Professional Rocket League team', gradient: 'from-yellow-500 to-orange-500' }
        ];
      }
      
      showJoinClanModal(clan) {
        const joinInfo = document.getElementById('join-clan-info');
        joinInfo.innerHTML = `
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r ${clan.gradient} rounded-lg flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl font-bold text-white">${clan.tag}</span>
            </div>
            <h4 class="text-lg font-bold text-white mb-2">${clan.name}</h4>
            <p class="text-gray-400 text-sm mb-4">${clan.description}</p>
            <div class="grid grid-cols-3 gap-2 text-sm">
              <div>
                <div class="text-gaming-accent font-bold">${clan.members}/50</div>
                <div class="text-gray-500">Members</div>
              </div>
              <div>
                <div class="text-gaming-accent font-bold">${clan.wins}</div>
                <div class="text-gray-500">Wins</div>
              </div>
              <div>
                <div class="text-gaming-accent font-bold">${clan.rating}‚≠ê</div>
                <div class="text-gray-500">Rating</div>
              </div>
            </div>
          </div>
        `;
        
        // Store clan data for confirmation
        document.getElementById('confirm-join-clan').dataset.clanId = clan.id;
        
        // Show join modal
        document.getElementById('join-clan-modal').classList.remove('hidden');
      }
      
      confirmJoinClan() {
        const clanId = document.getElementById('confirm-join-clan').dataset.clanId;
        console.log(`üéØ Joining clan ${clanId}...`);
        
        // Close modals
        this.closeJoinClanModal();
        this.closeClanBrowser();
        
        // Show success notification
        this.showNotification('üéâ Successfully joined clan! Welcome to the team!', 'success');
      }
      
      closeJoinClanModal() {
        document.getElementById('join-clan-modal').classList.add('hidden');
      }
      
      closeClanBrowser() {
        document.getElementById('clan-browser-modal').classList.add('hidden');
        console.log('‚ùå Clan browser closed');
      }
      
      filterClans(searchTerm = '', type = 'all') {
        const items = document.querySelectorAll('.clan-browser-item');
        items.forEach(item => {
          const name = item.querySelector('h4').textContent.toLowerCase();
          const description = item.querySelector('p').textContent.toLowerCase();
          const isRecruiting = item.textContent.includes('‚úÖ Recruiting');
          
          const matchesSearch = !searchTerm || name.includes(searchTerm.toLowerCase()) || description.includes(searchTerm.toLowerCase());
          const matchesType = type === 'all' || 
                             (type === 'recruiting' && isRecruiting) ||
                             (type === 'competitive' && description.includes('competitive')) ||
                             (type === 'casual' && description.includes('casual'));
          
          item.style.display = matchesSearch && matchesType ? '' : 'none';
        });
      }
      
      sortClans(sortBy) {
        const container = document.getElementById('clan-browser-list');
        const items = Array.from(container.querySelectorAll('.clan-browser-item'));
        
        items.sort((a, b) => {
          let aVal, bVal;
          
          switch(sortBy) {
            case 'members':
              aVal = parseInt(a.textContent.match(/üë• (\d+)/)[1]);
              bVal = parseInt(b.textContent.match(/üë• (\d+)/)[1]);
              return bVal - aVal;
            case 'wins':
              aVal = parseInt(a.textContent.match(/üèÜ (\d+)W/)[1]);
              bVal = parseInt(b.textContent.match(/üèÜ (\d+)W/)[1]);
              return bVal - aVal;
            case 'rating':
              aVal = parseFloat(a.textContent.match(/‚≠ê ([\d.]+)/)[1]);
              bVal = parseFloat(b.textContent.match(/‚≠ê ([\d.]+)/)[1]);
              return bVal - aVal;
            default:
              return 0;
          }
        });
        
        // Re-append sorted items
        items.forEach(item => container.appendChild(item));
      }
      
      performClanSearch(query) {
        console.log('üîç Performing clan search:', query);
        
        // Get active filter
        const activeFilter = document.querySelector('.clan-filter.active');
        const filter = activeFilter ? activeFilter.dataset.filter : 'all';
        
        // Get clan items
        const clanItems = document.querySelectorAll('.clan-item');
        let visibleCount = 0;
        
        if (!query.trim()) {
          // Show all items if no search query
          clanItems.forEach(item => {
            item.style.display = '';
            visibleCount++;
          });
        } else {
          // Filter items based on search query
          clanItems.forEach(item => {
            const name = item.dataset.name?.toLowerCase() || '';
            const tag = item.dataset.tag?.toLowerCase() || '';
            const founder = item.dataset.founder?.toLowerCase() || '';
            const type = item.dataset.type?.toLowerCase() || '';
            
            const queryLower = query.toLowerCase();
            const matchesSearch = name.includes(queryLower) || 
                                tag.includes(queryLower) || 
                                founder.includes(queryLower);
                                
            const matchesFilter = filter === 'all' || 
                                type === filter ||
                                (filter === 'top-100' && visibleCount < 100) ||
                                (filter === 'recruiting' && item.textContent.toLowerCase().includes('recruiting'));
            
            if (matchesSearch && matchesFilter) {
              item.style.display = '';
              this.highlightClanSearchTerms(item, query);
              visibleCount++;
            } else {
              item.style.display = 'none';
            }
          });
        }
        
        // Update results count
        this.updateClanSearchResultsCount(visibleCount, query);
      }
      
      setActiveClanFilter(clickedFilter) {
        // Remove active class from all filters
        document.querySelectorAll('.clan-filter').forEach(filter => {
          filter.classList.remove('active', 'bg-gaming-accent', 'text-black');
          filter.classList.add('bg-gaming-surface', 'text-gray-400');
        });
        
        // Add active class to clicked filter
        clickedFilter.classList.add('active', 'bg-gaming-accent', 'text-black');
        clickedFilter.classList.remove('bg-gaming-surface', 'text-gray-400');
      }
      
      highlightClanSearchTerms(item, query) {
        const nameElement = item.querySelector('h3');
        if (nameElement && query.trim()) {
          const originalText = nameElement.dataset.originalText || nameElement.textContent;
          nameElement.dataset.originalText = originalText;
          
          const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
          const highlightedText = originalText.replace(regex, '<span class="bg-gaming-yellow text-black px-1 rounded">$1</span>');
          nameElement.innerHTML = highlightedText;
        }
      }
      
      updateClanSearchResultsCount(count, query) {
        const resultsCountEl = document.getElementById('clan-search-results-count');
        const countEl = document.getElementById('clan-results-count');
        
        if (resultsCountEl && countEl) {
          countEl.textContent = count;
          
          if (query.trim()) {
            resultsCountEl.classList.remove('hidden');
          } else {
            resultsCountEl.classList.add('hidden');
          }
        }
      }
    }
    
    // Universal navigation handler for both SPA and multi-page modes
    function handleNavigation(event, pageUrl) {
      // Check if SPA router is available and ready
      if (window.router && window.router.push && typeof window.router.push === 'function') {
        event.preventDefault();
        const routePath = '/' + pageUrl.replace('.html', '').replace('index', 'dashboard');
        window.router.push(routePath);
      }
      // If no SPA router, let the default link behavior happen (multi-page navigation)
    }
    
    // Active navigation state management
    function updateActiveNavigation(currentPage) {
      // Remove active class from all nav links
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('bg-gaming-accent', 'text-black', 'bg-gaming-purple', 'text-white');
        link.classList.add('text-gray-300');
      });
      
      // Add active class to current page link with appropriate styling
      const activeLink = document.querySelector(`.nav-link[href="${currentPage}"]`);
      if (activeLink) {
        activeLink.classList.remove('text-gray-300');
        if (currentPage === 'clans.html') {
          activeLink.classList.add('bg-gaming-purple', 'text-white');
        } else {
          activeLink.classList.add('bg-gaming-accent', 'text-black');
        }
      }
    }
    
    // Make navigation functions globally available
    window.handleNavigation = handleNavigation;
    window.updateActiveNavigation = updateActiveNavigation;
    
    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      new ClanPlatform();
    });
  </script>
</body>
</html>